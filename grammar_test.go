// -*- coding: utf-8 -*-

// Created on Tue Jul 29 10:12:42 AM EDT 2025
// author: Ryan Hildebrandt, github.com/ryancahildebrandt

package main

import (
	"bufio"
	"os"
	"testing"

	"github.com/stretchr/testify/assert"
)

func TestGrammar_print(t *testing.T) {
	var emp = "#JSGF V1.0 ISO8859-1 en;\n\ngrammar main;"
	var tk = NewUnigramTokenizer()

	type args struct {
		f string
	}
	tests := []struct {
		name string
		args args
		want string
	}{
		{name: "", args: args{f: "./data/tests/test1.csv"}, want: "#JSGF V1.0 ISO8859-1 en;\n\ngrammar main;\n\npublic <I_don't_have_a_profi> = (I don't have a profile);\npublic <I_don't_have_a_profi_1> = (I don't have a profile);\npublic <I_don't_have_a_user_> = (I don't have a user account);\npublic <I_don't_have_an_onli> = (I don't have an online account);\npublic <I_don't_have> = (I don't have) (a account);\npublic <I_have_no_account> = (I have no account);\npublic <I_have_no_fucking_ac> = (I have no fucking account);\npublic <I_have_no_online_acc> = (I have no online account);\npublic <I_have_no_user_accou> = (I have no user account);\npublic <I_have_no_user_accou_1> = (I have no user account);\npublic <I_haven't_got_a_prof> = (I haven't got a profile);\npublic <I_haven't_got_a_user> = (I haven't got a user account);\npublic <I_haven't_got_an_acc> = (I haven't got an account);\npublic <I_haven't_got_an_onl> = (I haven't got an online account);\npublic <I_haven't_got_auser_> = (I haven't got auser account);\npublic <I_need_a_user_accoun> = (I need a user account and I want to) (create one);\npublic <I_need_an_account_an> = (I need an account and I want to open one);\npublic <I_need_an_account> = (I need an account);\npublic <I_need_an_online_acc> = (I need an online account);\npublic <I_want_a_user_accoun> = (I want a user account);\npublic <I_want_a_user_accoun_1> = (I want a user account);\npublic <I_want_an_account> = (I want an account);\npublic <I_want_to_create_an_> = (I want to create an online account);\npublic <I_want_to_know_if_I_> = (I want to know if I can create more than one account with a single email);\npublic <I_want_to_know_if_I__1> = (I want to know if I can create more than one account with the same email address);\npublic <I_want_to_know_if_I_> = (I want to know if I can create more than one online account with a single email address);\npublic <I_want_to_know_if_I__1> = (I want to know if I can register more than one user account with a single email address);\npublic <I_want_to_know_if_I_> = (I want to know if I can register more than one user account with a single email);\npublic <I_want_to_know_if_I__1> = (I want to know if I can register several profiles with the same email address);\npublic <I_want_to_know_if_I_> = (I want to know if I can register several user accounts with the same email address);\npublic <I_want_to_know_if_I__1> = (I want to know if I can register two accounts with a single email address);\npublic <I_want_to_know_if_I> = (I want to know if I) (can have several accounts);\npublic <I_want_to_know_if_I_1> = (I want to know if I) (can own several accounts);\npublic <I_want_to_open_a_use> = (I want to open a user account);\npublic <I_want> = (I want) (a profille);\npublic <to_knoe_if_I_can_cre> = (I want) (to knoe if I can create two profiles) (with an single email address);\npublic <to_nkow_if_I_can_reg> = (I want) (to nkow if I can register two accounts with the same email);\npublic <I_want> = (I want) (to register);\npublic <a_fucking_user_accou> = (I would like) (a fucking user account);\npublic <I'd_like_a_user_acco> = (I'd like a user account);\npublic <I've_got_no_account> = (I've got no account);\npublic <I've_got_no_account_1> = (I've got no account);\npublic <I've_got_no_profile> = (I've got no profile);\npublic <ask_an_agent_how> = (ask an agent how) (i could create a user account);\npublic <have_more_than_one_o> = (can i) (have more than one online account ?);\npublic <register_?> = (can i) (register ?);\npublic <can_you_tell_me_if_I> = (can you tell me if I can create more than one user account with the same email ?);\npublic <can_you_tell_me_if_I_1> = (can you tell me if I can register several accounts with a single email ?);\npublic <can_you_tell_me_if_I> = (can you tell me if I can register several accounts with a single email address ?);\npublic <can_you_tell_me_if_i> = (can you tell me if i can create more than) (one fucking user account with the same email ?);\npublic <can_regisger_two_acc> = (can you tell me if i) (can regisger two accounts with a single email address ?);\npublic <I_could_create_two_a> = (can you tell me if) (I could create two accounts with a single email);\npublic <I_create_two_online_> = (can) (I create two online accounts with a single email ?);\npublic <I_own_more_than_one_> = (can) (I own more than one account ?);\npublic <i_own_more_than_one_> = (can) (i own more than one online account ?);\npublic <could_you_ask_an_age> = (could you ask an agent how to open an account);\npublic <I_create_an_online_a> = (how can) (I create an online account ?);\npublic <I_open_an_online_acc> = (how can) (I open an online account ?);\npublic <i_dont_have_a_profil> = (i dont have a profile);\npublic <i_dont_have_a_user_a> = (i dont have a user account and i want to open one);\npublic <i_dont_have_a> = (i dont have a) (user accolunt);\npublic <i_dont_have_an_onlin> = (i dont have an online account);\npublic <i_dont_have> = (i dont have) (a account);\npublic <i_have_no_account> = (i have no account);\npublic <i_need_help_register> = (i need help registering);\npublic <i_wanna_know_if_i_ca> = (i wanna know if i can create more than one user account with a single email address);\npublic <i_wanna_know_if_i_ca_1> = (i wanna know if i can create two online accounts with a single email address);\npublic <i_wanna_know_if_i_ca> = (i wanna know if i can register more) (than oneuser account with the same email);\npublic <i_want_a_profile> = (i want a profile);\npublic <i_want_an_account> = (i want an account);\npublic <i_want_an_online_acc> = (i want an online account);\npublic <i_want_to_create_an_> = (i want to create an account);\npublic <i_want_to_know_if_i_> = (i want to know if i can create two accounts with a single email address);\npublic <i_want_to_know_if_i> = (i want to know if i) (can have several accounts);\npublic <i_could_create_two_p> = (i want to know if) (i could create two profiles with the same email address);\npublic <i_watn_to_know_if_i_> = (i watn to know if i can register two profiles with the same email address);\npublic <ive_got_no_online_ac> = (ive got no online account);\npublic <please> = (please);\npublic <tell_me_if_I_can_cre> = (tell me if I can create two online accounts with the same email);\npublic <tell_me_if_I_can_reg> = (tell me if I can register two accounts with a single email address);\npublic <tell_me_if_I_can_reg_1> = (tell me if I can register two online accounts with the same email);\npublic <two_user_accounts_wi> = (tell me if I could register) (two user accounts with a single email address);\npublic <an_onlind_account> = (were to create) (an onlind account);"},
		{name: "", args: args{f: "./data/tests/test2.csv"}, want: "#JSGF V1.0 ISO8859-1 en;\n\ngrammar main;\n\npublic <I_acn't_understand_y> = (I acn't understand you);\npublic <I_ahve_a_problem_whe> = (I ahve a problem when trying to pay for my online order);\npublic <I_ahve_an_issue_when> = (I ahve an issue when trying) (to make a payment);\npublic <I_ahve_no_account> = (I ahve no account);\npublic <I_am_discontent_with> = (I am discontent with the service and I want) (to submit a consumer complaint);\npublic <I_am_discontent_with_1> = (I am discontent with the service);\npublic <I_am_happy_with_the_> = (I am happy with the service and I'd like tro submit an opinion);\npublic <I_am_happy_with_the__1> = (I am happy with the service and I'd like) (to lodge a review);\npublic <I_am_happy_with_the_> = (I am happy with the service and) (I would like to make an opinion);\npublic <I_am_happy_with_the__1> = (I am happy with the service and) (I would like to submit an opinion);\npublic <I_am_happy_with_the_> = (I am happy with the service);\npublic <I_am_interested_in_t> = (I am interested in their fucking money back guarantee);\npublic <I_am_interested_in_y> = (I am interested in your fucking refund policy and I want to know about it);\npublic <I_am_interested_in_y_1> = (I am interested in your fucking reimbursement policy);\npublic <I_am_not_happy_with_> = (I am not happy with the service and I want) (to lodge a complaint);\npublic <I_am_not_happy_with__1> = (I am not happy with the service);\npublic <I_ant_to_know_what> = (I ant to know what) (the mail address of the Customer Support is);\npublic <to_ask_for_informati> = (I ant) (to ask for information about modifying my purchase);\npublic <to_notify_problems_m> = (I ant) (to notify problems making a payment);\npublic <to_recover_my_passwo> = (I ant) (to recover my password);\npublic <I_awnna_know_somethi> = (I awnna know something about seeing an invoice);\npublic <I_boguht_a_product> = (I boguht a product);\npublic <I_bought_a_product_a> = (I bought a product and I want) (to change my purchase);\npublic <I_bought_a_product_a_1> = (I bought a product and I want) (to modify my order);\npublic <I_bought_a_product_a> = (I bought a product and I want) (to modify my purchase);\npublic <I_bought_a_product_a_1> = (I bought a product and) (I wanna change my purchase);\npublic <I_bought_a_product_a> = (I bought a product and) (I wanna modify my order);\npublic <I_bought_a_product> = (I bought a product);\npublic <I_bought_a_product_1> = (I bought a product);\npublic <I_bought_an_item> = (I bought an item);\npublic <I_bought> = (I bought) (a prodjct);\npublic <I_don't_have_an_onli> = (I don't have an online account);\npublic <I_forgot_my_password> = (I forgot my password and I want) (to retrieve it);\npublic <I_found_an_issue_ope> = (I found an issue opening an account);\npublic <I_have_a_problem_whe> = (I have a problem when trying to pay for my online order and) (I ant to notify it);\npublic <I_have_a_problem_whe_1> = (I have a problem when trying to pay);\npublic <I_have_no_user_accou> = (I have no user account);\npublic <I_need_help_informin> = (I need help informing of problems) (with my payment);\npublic <I_ordered_something> = (I ordered something);\npublic <I_can_know_where_my_> = (I want to know how) (I can know where my deliveries are);\npublic <I_can_create_several> = (I want to know if) (I can create several profiles with) (the same email);\npublic <the_hours_of_Custome> = (I want to know what) (the hours of Customer Service are);\npublic <the_status_of_my_ord> = (I want to see) (the status of my order);\npublic <to_remove_my_online_> = (I want) (to remove my online account);\npublic <to_track_my_deliveri> = (I want) (to track my deliveries);\npublic <to_view_your_payment> = (I want) (to view your payment options);\npublic <a_question> = (have) (a question);\npublic <a_user_account> = (havent got) (a user account) (and i wannaregister);\npublic <need_ehlp_modifying> = (need ehlp modifying) (my profile);\npublic <need_help_informing_> = (need help informing of issues paying);\npublic <to_check_your_money_> = (wan) (to check your money back guarantee);\npublic <want_to_know_if> = (want to know if) (I can track my shipments);\npublic <to_request_some_bill> = (want) (to request some bills);"},
		{name: "", args: args{f: "./data/tests/test3.csv"}, want: "#JSGF V1.0 ISO8859-1 en;\n\ngrammar main;\n\npublic <my_bills_and_I_want_> = (<I_can't_find>) (my bills and I want to view them);\npublic <my_bills_and_I_want> = (<I_can't_find>) (my bills and I want) (to see them);\npublic <<I_can't_find>> = (<I_can't_find>) (my bills);\npublic <<I_can't_find>_1> = (<I_can't_find>) (my bills);\npublic <my_bklls_and_I_want> = (<I_can't_find>) (my bklls and I want) (to check them);\npublic <<I_can't_find>> = (<I_can't_find>) (my fucking bills);\npublic <<I_can't_find>_1> = (<I_can't_find>) (my fucking invoice);\npublic <my_invoices_and_I_wa> = (<I_can't_find>) (my invoices and I want) (to check them);\npublic <my_invoices_and_I_wa_1> = (<I_can't_find>) (my invoices and I want) (to see them);\npublic <<I_can't_find>> = (<I_can't_find>) (my invoices);\npublic <<I_can't_find>_1> = (<I_can't_find>) (my invoices);\npublic <I_acn't_understand_y> = (I acn't understand you);\npublic <I_ahve_a_problem_whe> = (I ahve a problem when trying) (to pay for my online order);\npublic <I_ahve_an_issue_when> = (I ahve an issue when trying) (to make a payment);\npublic <I_ahve_no_account> = (I ahve no account);\npublic <I_am_discontent_with> = (I am discontent with the service and I want) (to submit a consumer complaint);\npublic <I_am_discontent_with_1> = (I am discontent with the service);\npublic <I_am_happy_with_the_> = (I am happy with the service and) (I would like to make an opinion);\npublic <I_am_happy_with_the__1> = (I am happy with the service and) (I would like to submit an opinion);\npublic <I_am_happy_with_the_> = (I am happy with the service) (and I'd like to lodge a review);\npublic <and_I'd_like_tro_sub> = (I am happy with the service) (and I'd like tro submit an opinion);\npublic <I_am_happy_with_the_> = (I am happy with the service);\npublic <I_am_interested_in_t> = (I am interested in their fucking money back guarantee);\npublic <I_am_interested_in_y> = (I am interested in your fucking refund policy and I want to know about it);\npublic <I_am_interested_in_y_1> = (I am interested in your fucking reimbursement policy);\npublic <I_am_not_happy_with_> = (I am not happy with the service and I want) (to lodge a complaint);\npublic <I_am_not_happy_with__1> = (I am not happy with the service);\npublic <I_ant_to_know_what> = (I ant to know what) (the mail address of the Customer Support is);\npublic <to_ask_for_informati> = (I ant) (to ask for information about modifying my purchase);\npublic <to_notify_problems_m> = (I ant) (to notify problems making) (a payment);\npublic <I_ant> = (I ant) (to recover my password);\npublic <I_awnna_know_somethi> = (I awnna know something about seeing) (an invoice);\npublic <I_boguht_a_product> = (I boguht a product);\npublic <I_bought_a_product_a> = (I bought a product and I want to change my purchase);\npublic <I_bought_a_product_a_1> = (I bought a product and I want to modify my order);\npublic <I_bought_a_product_a> = (I bought a product and I want to modify my purchase);\npublic <I_bought_a_product_a_1> = (I bought a product and) (I wanna change my purchase);\npublic <I_bought_a_product_a> = (I bought a product and) (I wanna modify my order);\npublic <I_bought_a_product> = (I bought a product);\npublic <I_bought_a_product_1> = (I bought a product);\npublic <I_bought_an_item_and> = (I bought an item and I want to change my order);\npublic <I_bought_an_item_and_1> = (I bought an item and I want to change my purchase);\npublic <I_bought_an_item_and> = (I bought an item and I want to modify my order);\npublic <I_bought_an_item_and_1> = (I bought an item ands I want to modify my purchase);\npublic <and_i'd_like_to_modi> = (I bought an item) (and i'd like to modify my order);\npublic <I_bought_an_item> = (I bought an item);\npublic <I_bought_an_item_1> = (I bought an item);\npublic <I_bought_something_a> = (I bought something and I want to change my order);\npublic <I_bought_something_a_1> = (I bought something and I want to change my purchase);\npublic <I_bought_something_a> = (I bought something and I want to modify my order);\npublic <I_wanna_change_my_pu> = (I bought something and) (I wanna change my purchase);\npublic <and_Id_like_to_chang> = (I bought something) (and Id like to change my purchase);\npublic <and_want_to_modify_m> = (I bought something) (and want to modify my purchase);\npublic <I_bought_something> = (I bought something);\npublic <I_bought> = (I bought) (a prodjct);\npublic <I_bought_1> = (I bought) (an product);\npublic <I_bougyt_an_item> = (I bougyt an item);\npublic <I_bouvht_a_product_a> = (I bouvht a product and I want to change my order);\npublic <I_ca't_remember> = (I ca't remember) (my password);\npublic <my_fucking_password_> = (I can' remember) (my fucking password and) (I would like to reset it);\npublic <a_profile> = (I can't create) (a profile);\npublic <my_invoices> = (I can't dind) (my invoices);\npublic <my_bills> = (I can't fidn) (my bills);\npublic <I_can't_find_my_bill> = (I can't find my bill and I want to view it);\npublic <I_can't_find_my_bill_1> = (I can't find my bill and I want) (to check it);\npublic <I_can't_find_my_bill> = (I can't find my bill and I want) (to see it);\npublic <and_I'd_like_to_view> = (I can't find my bill) (and I'd like to view it);\npublic <I_can't_find_my_bill> = (I can't find my bill);\npublic <I_can't_find_my_bill_1> = (I can't find my bill);\npublic <I_would_like_to_view> = (I can't find my fucking invoices and) (I would like to view them);\npublic <I_can't_find_my_invo> = (I can't find my invoice and I want to view it);\npublic <I_can't_find_my_invo_1> = (I can't find my invoice and I want) (to check it);\npublic <I_can't_find_my_invo> = (I can't find my invoice andI want) (to see it);\npublic <I_can't_find_my_invo_1> = (I can't find my invoice);\npublic <I_can't_find_my_invo> = (I can't find my invoice);\npublic <I_can't_find_my_invo_1> = (I can't find my invoice);\npublic <I_don't_have> = (I don't have) (an online account);\npublic <my_password_and_I_wa> = (I forgot) (my password and I want) (to retrieve it);\npublic <I_found_an_issue_ope> = (I found an issue opening) (an account);\npublic <I_have_a_problem_whe> = (I have a problem when trying) (to pay for my online order and I ant to notify it);\npublic <I_have_a_problem_whe_1> = (I have a problem when trying) (to pay);\npublic <I_have_no_user_accou> = (I have no user account);\npublic <I_need_help_informin> = (I need help informing of problems) (with my payment);\npublic <I_ordered_something> = (I ordered something);\npublic <I_want_to_know_how> = (I want to know how) (I can know where my deliveries are);\npublic <I_can_create_several> = (I want to know if) (I can create several profiles with) (the same email);\npublic <the_hours_of_Custome> = (I want to know what) (the hours of Customer Service are);\npublic <my_online_account> = (I want to remove) (my online account);\npublic <the_status_of_my_ord> = (I want to see) (the status of my order);\npublic <I_want_to_view_your_> = (I want to view your payment options);\npublic <I_want> = (I want) (to track my deliveries);\npublic <bought_na_item> = (I) (bought na item);\npublic <bought_somethikng> = (I) (bought somethikng);\npublic <can't_understand_you> = (I) (can't understand you);\npublic <a_question> = (have) (a question);\npublic <a_user_account> = (havent got) (a user account) (and i wannaregister);\npublic <need_ehlp_modifying> = (need ehlp modifying) (my profile);\npublic <need_help_informing_> = (need help informing of issues paying);\npublic <to_check_your_money_> = (wan) (to check your money back guarantee);\npublic <want_to_know_if> = (want to know if) (I can track my shipments);\npublic <to_request_some_bill> = (want) (to request some bills);\n\n<I_can't_find> = (I can't find);"},
		{name: "", args: args{f: "./data/tests/test4.csv"}, want: "#JSGF V1.0 ISO8859-1 en;\n\ngrammar main;\n\npublic <I_bought> = (I bought) (an item);\npublic <I_can't_find> = (I can't find) (my bill);\npublic <I_can't_find_1> = (I can't find) (my bills);\npublic <my_invoice_and_I_wan> = (I can't find) (my invoice and I want to view it);\npublic <I_can't_find> = (I can't find) (my invoice);\npublic <I_can't_remember> = (I can't remember) (my passwprd);\npublic <I_changed> = (I changed) (my mind);\npublic <I_didn't_receive> = (I didn't receive) (my invoices);\npublic <an_online_account> = (I don't have) (an online account);\npublic <I_don't_know_anythin> = (I don't know anything about your money back guarantee and I want information about it);\npublic <I_don't_know_anythin_1> = (I don't know anything about your money back policy and I want information about it);\npublic <I_don't_know_anythin> = (I don't know anything about your refund policy);\npublic <I_get_an_error_when> = (I get an error when) (I attempt to pay);\npublic <I_attempted_to_pay> = (I got an erreor when) (I attempted to pay);\npublic <I_attempted_to_make_> = (I got an error message when) (I attempted to make a payment);\npublic <I_have_a_problem_whe> = (I have a problem when trying ot make a payment with card);\npublic <I_have_a_problem_whe_1> = (I have a problem when trying to make a payment);\npublic <I_have_a_problem_whe> = (I have a problem when trying to pay);\npublic <I_have_an_issue_maki> = (I have an issue making) (a paymet);\npublic <I_have_an_issue_payi> = (I have an issue paying for my order);\npublic <I_have_no_shipping_a> = (I have no shipping address);\npublic <I_need_help_viewing> = (I need help viewing) (my bills);\npublic <I_need_information> = (I need information);\npublic <I_want_a_reimburseme> = (I want a reimbursement);\npublic <about_obtaining_an_i> = (I want to ask for information) (about obtaining an invoice);\npublic <to_change_my_order> = (I want to know how) (to change my order);\npublic <I_want_to_make> = (I want to make) (a comment);\npublic <I_want_to_make_1> = (I want to make) (a complaint for a service);\npublic <my_other_account> = (I want to use) (my other account);\npublic <I_want_to_view_cance> = (I want to view cancellation penalties);\npublic <I_want_to_view_your_> = (I want to view your reimbursement policy);\npublic <I_want> = (I want) (to download a bill);\npublic <to_get_information_a> = (I want) (to get information about downloading some invoices);\npublic <I_want> = (I want) (to submit a complaint);\npublic <to_see_the_status_of> = (I'd like) (to see the status of my order);\npublic <I'm_happy_wiht> = (I'm happy wiht) (the service);\npublic <I_try_to_pay_for_my_> = (an error message pops when) (I try to pay for my order);\npublic <ask_an_agent_how> = (ask an agent how) (to file an consumer complaint);\npublic <ask_an_agent_how_1> = (ask an agent how) (to modufy my purchase);\npublic <can_report_an_issue_> = (ask an agent where i) (can report an issue paying);\npublic <to_show_me_informati> = (ask an agent) (to show me information about) (the delivery period);\npublic <a_purchase_?> = (can I cancel) (a purchase ?);\npublic <my_account_password_> = (can I retrieve) (my account password ?);\npublic <my_user_account_?> = (can i close) (my user account ?);\npublic <can_check_their_mone> = (can u ask an agent if i) (can check their money back guarantee ?);\npublic <can_u_ask_an_agent_i> = (can u ask an agent if) (i could see the status of my refund);\npublic <can_you_find_informa> = (can you find information about) (the cancellation penalties ?);\npublic <can_you_show_me_the_> = (can you show me the mail of the Client Service ?);\npublic <can_register_two_acc> = (can you tell me if I) (can register two accounts with the same email ?);\npublic <I_can_create_several> = (can you tell me if) (I can create several accounts with the same email ?);\npublic <I_can_create_several_1> = (can you tell me if) (I can create several accounts with the same email address ?);\npublic <i_create_several_pro> = (can) (i create several profiles with the same email ?);\npublic <could_you_ask_an_age> = (could you ask an agent where) (to inform of fucking problems with my payment ?);\npublic <a_full_refund_in_cas> = (do I get) (a full refund in case) (I cancel my ticket ?);\npublic <a_fucking_payment_pr> = (help me notify) (a fucking payment problem);\npublic <help_me_obtain_an_in> = (help me obtain an invoice);\npublic <an_order_?> = (how can i make) (an order ?);\npublic <I_obtain_a_reimburse> = (how can) (I obtain a reimbursement ?);\npublic <i_notify_issues_payi> = (how could) (i notify issues paying ?);\npublic <an_online_account> = (i dont have) (an online account);\npublic <i_attempted_to_make_> = (i got an error when) (i attempted to make a payment);\npublic <i_got_an_error_when> = (i got an error when) (i tried to pay);\npublic <i_have_a_problem_mak> = (i have a problem making a payment with card);\npublic <i_have_an_issue_payi> = (i have an issue paying);\npublic <i_need_help_viewing_> = (i need help viewing your payment methods);\npublic <i_need_information> = (i need information);\npublic <a_product> = (i obught) (a product);\npublic <i_wanna_check> = (i wanna check) (my delivery);\npublic <i_wanna_get_an_invoi> = (i wanna get an invoice);\npublic <i_wanna_get> = (i wanna get) (a refund);\npublic <i_wanna_know_how_soo> = (i wanna know how soon) (i can expect my tickets);\npublic <a_review_for> = (i wanna make) (a review for) (a service);\npublic <i_wanna_notify_an_is> = (i wanna notify an issue making a payment);\npublic <i_wanna_see_the_mail> = (i wanna see the mail of the Client Service);\npublic <i_wanna_track> = (i wanna track) (my purchase);\npublic <i_wannaq_obtai_a_rei> = (i wannaq obtai a reimbursement);\npublic <about_requesting_som> = (i want to get information) (about requesting some invoices);\npublic <a_user_account> = (i want) (a user account);\npublic <to_inform_of_an_issu> = (i want) (to inform of an issue paying);\npublic <to_know_what_the_mai> = (i want) (to know what the mail of the Client Service is);\npublic <want_infomration> = (i) (want infomration);\npublic <information_about_do> = (information about downloading an invoice);\npublic <to_request_some_invo> = (is it possible) (to request some invoices ?);\npublic <my_online_account's_> = (my online account's been hacked);\npublic <please> = (please);\npublic <please_1> = (please);\npublic <my_account_password> = (someone stole) (my account password);\npublic <I_can_create_more_th> = (tell me if) (I can create more than one online account with) (a single email address);\npublic <tell_me_what_the_mai> = (tell me what the mail address of) (the Customer Support is);\npublic <tell_me_where> = (tell me where) (I can check my deliveries);\npublic <the_event_was_postpo> = (the event was postponed);\npublic <the_fucking_concert_> = (the fucking concert was postponed);\npublic <the_game_was_cancell> = (the game was cancelled);\npublic <a_review_?> = (where do i write) (a review ?);\npublic <I_notify_problems_pa> = (where do) (I notify problems paying ?);\npublic <i_see_your_payment_o> = (where do) (i see your payment options ?);\npublic <you_aren't_helping> = (you aren't helping);\npublic <you_arent_helping_an> = (you arent helping and i wanna talk) (to a human agent);\npublic <you_arent_helping> = (you arent helping);\npublic <your_not_helping> = (your not helping);\npublic <youre_not_helping> = (youre not helping);"},
		{name: "", args: args{f: "./data/tests/test5.csv"}, want: "#JSGF V1.0 ISO8859-1 en;\n\ngrammar main;\n\npublic <I_don't_have_an_onli> = (I don't have an online account);"},
		{name: "", args: args{f: "./data/tests/test6.csv"}, want: "#JSGF V1.0 ISO8859-1 en;\n\ngrammar main;\n\npublic <I_don't_have_an_onli> = (I don't have an online account);\npublic <I_don't_understand_y> = (I don't understand you);\npublic <I_got_an_error_messa> = (I got an error message when I attempted to make a payment);\npublic <I_want_an_online_acc> = (I want an online accoynt);\npublic <ask_an_agent_to_noti> = (ask an agent to notify issues with my payment);\npublic <can_you_show_me_info> = (can you show me information about the status of my refund ?);\npublic <can_you_show_me_my_i> = (can you show me my invoices ?);\npublic <can_you_tell_me_how_> = (can you tell me how I can get some bills ?);\npublic <i_dont_want_my_profi> = (i dont want my profile);\npublic <i_want_to_know_wat_t> = (i want to know wat the email of Customer Service is);\npublic <where_can_i_leave_an> = (where can i leave an opinion for a service ?);"},
		{name: "", args: args{f: "./data/tests/test7.csv"}, want: emp},
		{name: "", args: args{f: "./data/tests/test8.csv"}, want: emp},
		{name: "", args: args{f: "./data/tests/test9.csv"}, want: "#JSGF V1.0 ISO8859-1 en;\n\ngrammar main;\n\npublic <I_don't_have_an_onli> = (I don't have an online account);\npublic <I_have_a_question> = (I have a question);\npublic <I_ordered_an_item_an> = (I ordered an item and Id like to modify my fucking order);\npublic <I_want_to_download_a> = (I want to download a bill);\npublic <I_want_to_know_what_> = (I want to know what the number of Customer Service is);\npublic <I_want_to_make_a_rev> = (I want to make a review for a service);\npublic <how_do_I_make_change> = (how do I make changes to my shipping address ?);\npublic <i_get_an_error_messa> = (i get an error message when i ty to make a payment for my order);\npublic <i_want_to_request_an> = (i want to request an invoice);\npublic <where_do_i_check_the> = (where do i check the delivery options ?);\npublic <you_arent_helping> = (you arent helping);"},
		{name: "", args: args{f: "./data/tests/test10.csv"}, want: emp},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			file, _ := os.Open(tt.args.f)
			defer file.Close()
			s := bufio.NewScanner(file)
			tx := ReadTexts(s)
			c := NewCorpus(tx)
			c.transitions = NewTransitions(c, tk)
			c.ngrams = ToNgrams(c.texts, tk, c.transitions, 0.1)
			c.texts = SplitTriplets(c.texts, c.ngrams)
			rules := ToRules(c.texts)
			rules = ApplyFactor(rules)
			rules = SetIDs(rules)
			g := Grammar{Rules: rules}
			assert.Equal(t, tt.want, g.print())
		})
	}
}

func TestGrammar_printMain(t *testing.T) {
	var emp = "#JSGF V1.0 ISO8859-1 en;\n\ngrammar main;"
	var tk = NewUnigramTokenizer()

	type args struct {
		f string
	}
	tests := []struct {
		name string
		args args
		want string
	}{
		{name: "", args: args{f: "./data/tests/test1.csv"}, want: "#JSGF V1.0 ISO8859-1 en;\n\ngrammar main;\n\npublic <main> = (<I_don't_have_a_profi>|<I_don't_have_a_profi_1>|<I_don't_have_a_user_>|<I_don't_have_an_onli>|<I_don't_have>|<I_have_no_account>|<I_have_no_fucking_ac>|<I_have_no_online_acc>|<I_have_no_user_accou>|<I_have_no_user_accou_1>|<I_haven't_got_a_prof>|<I_haven't_got_a_user>|<I_haven't_got_an_acc>|<I_haven't_got_an_onl>|<I_haven't_got_auser_>|<I_need_a_user_accoun>|<I_need_an_account_an>|<I_need_an_account>|<I_need_an_online_acc>|<I_want_a_user_accoun>|<I_want_a_user_accoun_1>|<I_want_an_account>|<I_want_to_create_an_>|<I_want_to_know_if_I_>|<I_want_to_know_if_I__1>|<I_want_to_know_if_I_>|<I_want_to_know_if_I__1>|<I_want_to_know_if_I_>|<I_want_to_know_if_I__1>|<I_want_to_know_if_I_>|<I_want_to_know_if_I__1>|<I_want_to_know_if_I>|<I_want_to_know_if_I_1>|<I_want_to_open_a_use>|<I_want>|<to_knoe_if_I_can_cre>|<to_nkow_if_I_can_reg>|<I_want>|<a_fucking_user_accou>|<I'd_like_a_user_acco>|<I've_got_no_account>|<I've_got_no_account_1>|<I've_got_no_profile>|<ask_an_agent_how>|<have_more_than_one_o>|<register_?>|<can_you_tell_me_if_I>|<can_you_tell_me_if_I_1>|<can_you_tell_me_if_I>|<can_you_tell_me_if_i>|<can_regisger_two_acc>|<I_could_create_two_a>|<I_create_two_online_>|<I_own_more_than_one_>|<i_own_more_than_one_>|<could_you_ask_an_age>|<I_create_an_online_a>|<I_open_an_online_acc>|<i_dont_have_a_profil>|<i_dont_have_a_user_a>|<i_dont_have_a>|<i_dont_have_an_onlin>|<i_dont_have>|<i_have_no_account>|<i_need_help_register>|<i_wanna_know_if_i_ca>|<i_wanna_know_if_i_ca_1>|<i_wanna_know_if_i_ca>|<i_want_a_profile>|<i_want_an_account>|<i_want_an_online_acc>|<i_want_to_create_an_>|<i_want_to_know_if_i_>|<i_want_to_know_if_i>|<i_could_create_two_p>|<i_watn_to_know_if_i_>|<ive_got_no_online_ac>|<please>|<tell_me_if_I_can_cre>|<tell_me_if_I_can_reg>|<tell_me_if_I_can_reg_1>|<two_user_accounts_wi>|<an_onlind_account>);\n\n<I_don't_have_a_profi> = (I don't have a profile);\n<I_don't_have_a_profi_1> = (I don't have a profile);\n<I_don't_have_a_user_> = (I don't have a user account);\n<I_don't_have_an_onli> = (I don't have an online account);\n<I_don't_have> = (I don't have) (a account);\n<I_have_no_account> = (I have no account);\n<I_have_no_fucking_ac> = (I have no fucking account);\n<I_have_no_online_acc> = (I have no online account);\n<I_have_no_user_accou> = (I have no user account);\n<I_have_no_user_accou_1> = (I have no user account);\n<I_haven't_got_a_prof> = (I haven't got a profile);\n<I_haven't_got_a_user> = (I haven't got a user account);\n<I_haven't_got_an_acc> = (I haven't got an account);\n<I_haven't_got_an_onl> = (I haven't got an online account);\n<I_haven't_got_auser_> = (I haven't got auser account);\n<I_need_a_user_accoun> = (I need a user account and I want to) (create one);\n<I_need_an_account_an> = (I need an account and I want to open one);\n<I_need_an_account> = (I need an account);\n<I_need_an_online_acc> = (I need an online account);\n<I_want_a_user_accoun> = (I want a user account);\n<I_want_a_user_accoun_1> = (I want a user account);\n<I_want_an_account> = (I want an account);\n<I_want_to_create_an_> = (I want to create an online account);\n<I_want_to_know_if_I_> = (I want to know if I can create more than one account with a single email);\n<I_want_to_know_if_I__1> = (I want to know if I can create more than one account with the same email address);\n<I_want_to_know_if_I_> = (I want to know if I can create more than one online account with a single email address);\n<I_want_to_know_if_I__1> = (I want to know if I can register more than one user account with a single email address);\n<I_want_to_know_if_I_> = (I want to know if I can register more than one user account with a single email);\n<I_want_to_know_if_I__1> = (I want to know if I can register several profiles with the same email address);\n<I_want_to_know_if_I_> = (I want to know if I can register several user accounts with the same email address);\n<I_want_to_know_if_I__1> = (I want to know if I can register two accounts with a single email address);\n<I_want_to_know_if_I> = (I want to know if I) (can have several accounts);\n<I_want_to_know_if_I_1> = (I want to know if I) (can own several accounts);\n<I_want_to_open_a_use> = (I want to open a user account);\n<I_want> = (I want) (a profille);\n<to_knoe_if_I_can_cre> = (I want) (to knoe if I can create two profiles) (with an single email address);\n<to_nkow_if_I_can_reg> = (I want) (to nkow if I can register two accounts with the same email);\n<I_want> = (I want) (to register);\n<a_fucking_user_accou> = (I would like) (a fucking user account);\n<I'd_like_a_user_acco> = (I'd like a user account);\n<I've_got_no_account> = (I've got no account);\n<I've_got_no_account_1> = (I've got no account);\n<I've_got_no_profile> = (I've got no profile);\n<ask_an_agent_how> = (ask an agent how) (i could create a user account);\n<have_more_than_one_o> = (can i) (have more than one online account ?);\n<register_?> = (can i) (register ?);\n<can_you_tell_me_if_I> = (can you tell me if I can create more than one user account with the same email ?);\n<can_you_tell_me_if_I_1> = (can you tell me if I can register several accounts with a single email ?);\n<can_you_tell_me_if_I> = (can you tell me if I can register several accounts with a single email address ?);\n<can_you_tell_me_if_i> = (can you tell me if i can create more than) (one fucking user account with the same email ?);\n<can_regisger_two_acc> = (can you tell me if i) (can regisger two accounts with a single email address ?);\n<I_could_create_two_a> = (can you tell me if) (I could create two accounts with a single email);\n<I_create_two_online_> = (can) (I create two online accounts with a single email ?);\n<I_own_more_than_one_> = (can) (I own more than one account ?);\n<i_own_more_than_one_> = (can) (i own more than one online account ?);\n<could_you_ask_an_age> = (could you ask an agent how to open an account);\n<I_create_an_online_a> = (how can) (I create an online account ?);\n<I_open_an_online_acc> = (how can) (I open an online account ?);\n<i_dont_have_a_profil> = (i dont have a profile);\n<i_dont_have_a_user_a> = (i dont have a user account and i want to open one);\n<i_dont_have_a> = (i dont have a) (user accolunt);\n<i_dont_have_an_onlin> = (i dont have an online account);\n<i_dont_have> = (i dont have) (a account);\n<i_have_no_account> = (i have no account);\n<i_need_help_register> = (i need help registering);\n<i_wanna_know_if_i_ca> = (i wanna know if i can create more than one user account with a single email address);\n<i_wanna_know_if_i_ca_1> = (i wanna know if i can create two online accounts with a single email address);\n<i_wanna_know_if_i_ca> = (i wanna know if i can register more) (than oneuser account with the same email);\n<i_want_a_profile> = (i want a profile);\n<i_want_an_account> = (i want an account);\n<i_want_an_online_acc> = (i want an online account);\n<i_want_to_create_an_> = (i want to create an account);\n<i_want_to_know_if_i_> = (i want to know if i can create two accounts with a single email address);\n<i_want_to_know_if_i> = (i want to know if i) (can have several accounts);\n<i_could_create_two_p> = (i want to know if) (i could create two profiles with the same email address);\n<i_watn_to_know_if_i_> = (i watn to know if i can register two profiles with the same email address);\n<ive_got_no_online_ac> = (ive got no online account);\n<please> = (please);\n<tell_me_if_I_can_cre> = (tell me if I can create two online accounts with the same email);\n<tell_me_if_I_can_reg> = (tell me if I can register two accounts with a single email address);\n<tell_me_if_I_can_reg_1> = (tell me if I can register two online accounts with the same email);\n<two_user_accounts_wi> = (tell me if I could register) (two user accounts with a single email address);\n<an_onlind_account> = (were to create) (an onlind account);"},
		{name: "", args: args{f: "./data/tests/test2.csv"}, want: "#JSGF V1.0 ISO8859-1 en;\n\ngrammar main;\n\npublic <main> = (<I_acn't_understand_y>|<I_ahve_a_problem_whe>|<I_ahve_an_issue_when>|<I_ahve_no_account>|<I_am_discontent_with>|<I_am_discontent_with_1>|<I_am_happy_with_the_>|<I_am_happy_with_the__1>|<I_am_happy_with_the_>|<I_am_happy_with_the__1>|<I_am_happy_with_the_>|<I_am_interested_in_t>|<I_am_interested_in_y>|<I_am_interested_in_y_1>|<I_am_not_happy_with_>|<I_am_not_happy_with__1>|<I_ant_to_know_what>|<to_ask_for_informati>|<to_notify_problems_m>|<to_recover_my_passwo>|<I_awnna_know_somethi>|<I_boguht_a_product>|<I_bought_a_product_a>|<I_bought_a_product_a_1>|<I_bought_a_product_a>|<I_bought_a_product_a_1>|<I_bought_a_product_a>|<I_bought_a_product>|<I_bought_a_product_1>|<I_bought_an_item>|<I_bought>|<I_don't_have_an_onli>|<I_forgot_my_password>|<I_found_an_issue_ope>|<I_have_a_problem_whe>|<I_have_a_problem_whe_1>|<I_have_no_user_accou>|<I_need_help_informin>|<I_ordered_something>|<I_can_know_where_my_>|<I_can_create_several>|<the_hours_of_Custome>|<the_status_of_my_ord>|<to_remove_my_online_>|<to_track_my_deliveri>|<to_view_your_payment>|<a_question>|<a_user_account>|<need_ehlp_modifying>|<need_help_informing_>|<to_check_your_money_>|<want_to_know_if>|<to_request_some_bill>);\n\n<I_acn't_understand_y> = (I acn't understand you);\n<I_ahve_a_problem_whe> = (I ahve a problem when trying to pay for my online order);\n<I_ahve_an_issue_when> = (I ahve an issue when trying) (to make a payment);\n<I_ahve_no_account> = (I ahve no account);\n<I_am_discontent_with> = (I am discontent with the service and I want) (to submit a consumer complaint);\n<I_am_discontent_with_1> = (I am discontent with the service);\n<I_am_happy_with_the_> = (I am happy with the service and I'd like tro submit an opinion);\n<I_am_happy_with_the__1> = (I am happy with the service and I'd like) (to lodge a review);\n<I_am_happy_with_the_> = (I am happy with the service and) (I would like to make an opinion);\n<I_am_happy_with_the__1> = (I am happy with the service and) (I would like to submit an opinion);\n<I_am_happy_with_the_> = (I am happy with the service);\n<I_am_interested_in_t> = (I am interested in their fucking money back guarantee);\n<I_am_interested_in_y> = (I am interested in your fucking refund policy and I want to know about it);\n<I_am_interested_in_y_1> = (I am interested in your fucking reimbursement policy);\n<I_am_not_happy_with_> = (I am not happy with the service and I want) (to lodge a complaint);\n<I_am_not_happy_with__1> = (I am not happy with the service);\n<I_ant_to_know_what> = (I ant to know what) (the mail address of the Customer Support is);\n<to_ask_for_informati> = (I ant) (to ask for information about modifying my purchase);\n<to_notify_problems_m> = (I ant) (to notify problems making a payment);\n<to_recover_my_passwo> = (I ant) (to recover my password);\n<I_awnna_know_somethi> = (I awnna know something about seeing an invoice);\n<I_boguht_a_product> = (I boguht a product);\n<I_bought_a_product_a> = (I bought a product and I want) (to change my purchase);\n<I_bought_a_product_a_1> = (I bought a product and I want) (to modify my order);\n<I_bought_a_product_a> = (I bought a product and I want) (to modify my purchase);\n<I_bought_a_product_a_1> = (I bought a product and) (I wanna change my purchase);\n<I_bought_a_product_a> = (I bought a product and) (I wanna modify my order);\n<I_bought_a_product> = (I bought a product);\n<I_bought_a_product_1> = (I bought a product);\n<I_bought_an_item> = (I bought an item);\n<I_bought> = (I bought) (a prodjct);\n<I_don't_have_an_onli> = (I don't have an online account);\n<I_forgot_my_password> = (I forgot my password and I want) (to retrieve it);\n<I_found_an_issue_ope> = (I found an issue opening an account);\n<I_have_a_problem_whe> = (I have a problem when trying to pay for my online order and) (I ant to notify it);\n<I_have_a_problem_whe_1> = (I have a problem when trying to pay);\n<I_have_no_user_accou> = (I have no user account);\n<I_need_help_informin> = (I need help informing of problems) (with my payment);\n<I_ordered_something> = (I ordered something);\n<I_can_know_where_my_> = (I want to know how) (I can know where my deliveries are);\n<I_can_create_several> = (I want to know if) (I can create several profiles with) (the same email);\n<the_hours_of_Custome> = (I want to know what) (the hours of Customer Service are);\n<the_status_of_my_ord> = (I want to see) (the status of my order);\n<to_remove_my_online_> = (I want) (to remove my online account);\n<to_track_my_deliveri> = (I want) (to track my deliveries);\n<to_view_your_payment> = (I want) (to view your payment options);\n<a_question> = (have) (a question);\n<a_user_account> = (havent got) (a user account) (and i wannaregister);\n<need_ehlp_modifying> = (need ehlp modifying) (my profile);\n<need_help_informing_> = (need help informing of issues paying);\n<to_check_your_money_> = (wan) (to check your money back guarantee);\n<want_to_know_if> = (want to know if) (I can track my shipments);\n<to_request_some_bill> = (want) (to request some bills);"},
		{name: "", args: args{f: "./data/tests/test3.csv"}, want: "#JSGF V1.0 ISO8859-1 en;\n\ngrammar main;\n\npublic <main> = (<my_bills_and_I_want_>|<my_bills_and_I_want>|<<I_can't_find>>|<<I_can't_find>_1>|<my_bklls_and_I_want>|<<I_can't_find>>|<<I_can't_find>_1>|<my_invoices_and_I_wa>|<my_invoices_and_I_wa_1>|<<I_can't_find>>|<<I_can't_find>_1>|<I_acn't_understand_y>|<I_ahve_a_problem_whe>|<I_ahve_an_issue_when>|<I_ahve_no_account>|<I_am_discontent_with>|<I_am_discontent_with_1>|<I_am_happy_with_the_>|<I_am_happy_with_the__1>|<I_am_happy_with_the_>|<and_I'd_like_tro_sub>|<I_am_happy_with_the_>|<I_am_interested_in_t>|<I_am_interested_in_y>|<I_am_interested_in_y_1>|<I_am_not_happy_with_>|<I_am_not_happy_with__1>|<I_ant_to_know_what>|<to_ask_for_informati>|<to_notify_problems_m>|<I_ant>|<I_awnna_know_somethi>|<I_boguht_a_product>|<I_bought_a_product_a>|<I_bought_a_product_a_1>|<I_bought_a_product_a>|<I_bought_a_product_a_1>|<I_bought_a_product_a>|<I_bought_a_product>|<I_bought_a_product_1>|<I_bought_an_item_and>|<I_bought_an_item_and_1>|<I_bought_an_item_and>|<I_bought_an_item_and_1>|<and_i'd_like_to_modi>|<I_bought_an_item>|<I_bought_an_item_1>|<I_bought_something_a>|<I_bought_something_a_1>|<I_bought_something_a>|<I_wanna_change_my_pu>|<and_Id_like_to_chang>|<and_want_to_modify_m>|<I_bought_something>|<I_bought>|<I_bought_1>|<I_bougyt_an_item>|<I_bouvht_a_product_a>|<I_ca't_remember>|<my_fucking_password_>|<a_profile>|<my_invoices>|<my_bills>|<I_can't_find_my_bill>|<I_can't_find_my_bill_1>|<I_can't_find_my_bill>|<and_I'd_like_to_view>|<I_can't_find_my_bill>|<I_can't_find_my_bill_1>|<I_would_like_to_view>|<I_can't_find_my_invo>|<I_can't_find_my_invo_1>|<I_can't_find_my_invo>|<I_can't_find_my_invo_1>|<I_can't_find_my_invo>|<I_can't_find_my_invo_1>|<I_don't_have>|<my_password_and_I_wa>|<I_found_an_issue_ope>|<I_have_a_problem_whe>|<I_have_a_problem_whe_1>|<I_have_no_user_accou>|<I_need_help_informin>|<I_ordered_something>|<I_want_to_know_how>|<I_can_create_several>|<the_hours_of_Custome>|<my_online_account>|<the_status_of_my_ord>|<I_want_to_view_your_>|<I_want>|<bought_na_item>|<bought_somethikng>|<can't_understand_you>|<a_question>|<a_user_account>|<need_ehlp_modifying>|<need_help_informing_>|<to_check_your_money_>|<want_to_know_if>|<to_request_some_bill>);\n\n<I_can't_find> = (I can't find);\n<my_bills_and_I_want_> = (<I_can't_find>) (my bills and I want to view them);\n<my_bills_and_I_want> = (<I_can't_find>) (my bills and I want) (to see them);\n<<I_can't_find>> = (<I_can't_find>) (my bills);\n<<I_can't_find>_1> = (<I_can't_find>) (my bills);\n<my_bklls_and_I_want> = (<I_can't_find>) (my bklls and I want) (to check them);\n<<I_can't_find>> = (<I_can't_find>) (my fucking bills);\n<<I_can't_find>_1> = (<I_can't_find>) (my fucking invoice);\n<my_invoices_and_I_wa> = (<I_can't_find>) (my invoices and I want) (to check them);\n<my_invoices_and_I_wa_1> = (<I_can't_find>) (my invoices and I want) (to see them);\n<<I_can't_find>> = (<I_can't_find>) (my invoices);\n<<I_can't_find>_1> = (<I_can't_find>) (my invoices);\n<I_acn't_understand_y> = (I acn't understand you);\n<I_ahve_a_problem_whe> = (I ahve a problem when trying) (to pay for my online order);\n<I_ahve_an_issue_when> = (I ahve an issue when trying) (to make a payment);\n<I_ahve_no_account> = (I ahve no account);\n<I_am_discontent_with> = (I am discontent with the service and I want) (to submit a consumer complaint);\n<I_am_discontent_with_1> = (I am discontent with the service);\n<I_am_happy_with_the_> = (I am happy with the service and) (I would like to make an opinion);\n<I_am_happy_with_the__1> = (I am happy with the service and) (I would like to submit an opinion);\n<I_am_happy_with_the_> = (I am happy with the service) (and I'd like to lodge a review);\n<and_I'd_like_tro_sub> = (I am happy with the service) (and I'd like tro submit an opinion);\n<I_am_happy_with_the_> = (I am happy with the service);\n<I_am_interested_in_t> = (I am interested in their fucking money back guarantee);\n<I_am_interested_in_y> = (I am interested in your fucking refund policy and I want to know about it);\n<I_am_interested_in_y_1> = (I am interested in your fucking reimbursement policy);\n<I_am_not_happy_with_> = (I am not happy with the service and I want) (to lodge a complaint);\n<I_am_not_happy_with__1> = (I am not happy with the service);\n<I_ant_to_know_what> = (I ant to know what) (the mail address of the Customer Support is);\n<to_ask_for_informati> = (I ant) (to ask for information about modifying my purchase);\n<to_notify_problems_m> = (I ant) (to notify problems making) (a payment);\n<I_ant> = (I ant) (to recover my password);\n<I_awnna_know_somethi> = (I awnna know something about seeing) (an invoice);\n<I_boguht_a_product> = (I boguht a product);\n<I_bought_a_product_a> = (I bought a product and I want to change my purchase);\n<I_bought_a_product_a_1> = (I bought a product and I want to modify my order);\n<I_bought_a_product_a> = (I bought a product and I want to modify my purchase);\n<I_bought_a_product_a_1> = (I bought a product and) (I wanna change my purchase);\n<I_bought_a_product_a> = (I bought a product and) (I wanna modify my order);\n<I_bought_a_product> = (I bought a product);\n<I_bought_a_product_1> = (I bought a product);\n<I_bought_an_item_and> = (I bought an item and I want to change my order);\n<I_bought_an_item_and_1> = (I bought an item and I want to change my purchase);\n<I_bought_an_item_and> = (I bought an item and I want to modify my order);\n<I_bought_an_item_and_1> = (I bought an item ands I want to modify my purchase);\n<and_i'd_like_to_modi> = (I bought an item) (and i'd like to modify my order);\n<I_bought_an_item> = (I bought an item);\n<I_bought_an_item_1> = (I bought an item);\n<I_bought_something_a> = (I bought something and I want to change my order);\n<I_bought_something_a_1> = (I bought something and I want to change my purchase);\n<I_bought_something_a> = (I bought something and I want to modify my order);\n<I_wanna_change_my_pu> = (I bought something and) (I wanna change my purchase);\n<and_Id_like_to_chang> = (I bought something) (and Id like to change my purchase);\n<and_want_to_modify_m> = (I bought something) (and want to modify my purchase);\n<I_bought_something> = (I bought something);\n<I_bought> = (I bought) (a prodjct);\n<I_bought_1> = (I bought) (an product);\n<I_bougyt_an_item> = (I bougyt an item);\n<I_bouvht_a_product_a> = (I bouvht a product and I want to change my order);\n<I_ca't_remember> = (I ca't remember) (my password);\n<my_fucking_password_> = (I can' remember) (my fucking password and) (I would like to reset it);\n<a_profile> = (I can't create) (a profile);\n<my_invoices> = (I can't dind) (my invoices);\n<my_bills> = (I can't fidn) (my bills);\n<I_can't_find_my_bill> = (I can't find my bill and I want to view it);\n<I_can't_find_my_bill_1> = (I can't find my bill and I want) (to check it);\n<I_can't_find_my_bill> = (I can't find my bill and I want) (to see it);\n<and_I'd_like_to_view> = (I can't find my bill) (and I'd like to view it);\n<I_can't_find_my_bill> = (I can't find my bill);\n<I_can't_find_my_bill_1> = (I can't find my bill);\n<I_would_like_to_view> = (I can't find my fucking invoices and) (I would like to view them);\n<I_can't_find_my_invo> = (I can't find my invoice and I want to view it);\n<I_can't_find_my_invo_1> = (I can't find my invoice and I want) (to check it);\n<I_can't_find_my_invo> = (I can't find my invoice andI want) (to see it);\n<I_can't_find_my_invo_1> = (I can't find my invoice);\n<I_can't_find_my_invo> = (I can't find my invoice);\n<I_can't_find_my_invo_1> = (I can't find my invoice);\n<I_don't_have> = (I don't have) (an online account);\n<my_password_and_I_wa> = (I forgot) (my password and I want) (to retrieve it);\n<I_found_an_issue_ope> = (I found an issue opening) (an account);\n<I_have_a_problem_whe> = (I have a problem when trying) (to pay for my online order and I ant to notify it);\n<I_have_a_problem_whe_1> = (I have a problem when trying) (to pay);\n<I_have_no_user_accou> = (I have no user account);\n<I_need_help_informin> = (I need help informing of problems) (with my payment);\n<I_ordered_something> = (I ordered something);\n<I_want_to_know_how> = (I want to know how) (I can know where my deliveries are);\n<I_can_create_several> = (I want to know if) (I can create several profiles with) (the same email);\n<the_hours_of_Custome> = (I want to know what) (the hours of Customer Service are);\n<my_online_account> = (I want to remove) (my online account);\n<the_status_of_my_ord> = (I want to see) (the status of my order);\n<I_want_to_view_your_> = (I want to view your payment options);\n<I_want> = (I want) (to track my deliveries);\n<bought_na_item> = (I) (bought na item);\n<bought_somethikng> = (I) (bought somethikng);\n<can't_understand_you> = (I) (can't understand you);\n<a_question> = (have) (a question);\n<a_user_account> = (havent got) (a user account) (and i wannaregister);\n<need_ehlp_modifying> = (need ehlp modifying) (my profile);\n<need_help_informing_> = (need help informing of issues paying);\n<to_check_your_money_> = (wan) (to check your money back guarantee);\n<want_to_know_if> = (want to know if) (I can track my shipments);\n<to_request_some_bill> = (want) (to request some bills);"},
		{name: "", args: args{f: "./data/tests/test4.csv"}, want: "#JSGF V1.0 ISO8859-1 en;\n\ngrammar main;\n\npublic <main> = (<I_bought>|<I_can't_find>|<I_can't_find_1>|<my_invoice_and_I_wan>|<I_can't_find>|<I_can't_remember>|<I_changed>|<I_didn't_receive>|<an_online_account>|<I_don't_know_anythin>|<I_don't_know_anythin_1>|<I_don't_know_anythin>|<I_get_an_error_when>|<I_attempted_to_pay>|<I_attempted_to_make_>|<I_have_a_problem_whe>|<I_have_a_problem_whe_1>|<I_have_a_problem_whe>|<I_have_an_issue_maki>|<I_have_an_issue_payi>|<I_have_no_shipping_a>|<I_need_help_viewing>|<I_need_information>|<I_want_a_reimburseme>|<about_obtaining_an_i>|<to_change_my_order>|<I_want_to_make>|<I_want_to_make_1>|<my_other_account>|<I_want_to_view_cance>|<I_want_to_view_your_>|<I_want>|<to_get_information_a>|<I_want>|<to_see_the_status_of>|<I'm_happy_wiht>|<I_try_to_pay_for_my_>|<ask_an_agent_how>|<ask_an_agent_how_1>|<can_report_an_issue_>|<to_show_me_informati>|<a_purchase_?>|<my_account_password_>|<my_user_account_?>|<can_check_their_mone>|<can_u_ask_an_agent_i>|<can_you_find_informa>|<can_you_show_me_the_>|<can_register_two_acc>|<I_can_create_several>|<I_can_create_several_1>|<i_create_several_pro>|<could_you_ask_an_age>|<a_full_refund_in_cas>|<a_fucking_payment_pr>|<help_me_obtain_an_in>|<an_order_?>|<I_obtain_a_reimburse>|<i_notify_issues_payi>|<an_online_account>|<i_attempted_to_make_>|<i_got_an_error_when>|<i_have_a_problem_mak>|<i_have_an_issue_payi>|<i_need_help_viewing_>|<i_need_information>|<a_product>|<i_wanna_check>|<i_wanna_get_an_invoi>|<i_wanna_get>|<i_wanna_know_how_soo>|<a_review_for>|<i_wanna_notify_an_is>|<i_wanna_see_the_mail>|<i_wanna_track>|<i_wannaq_obtai_a_rei>|<about_requesting_som>|<a_user_account>|<to_inform_of_an_issu>|<to_know_what_the_mai>|<want_infomration>|<information_about_do>|<to_request_some_invo>|<my_online_account's_>|<please>|<please_1>|<my_account_password>|<I_can_create_more_th>|<tell_me_what_the_mai>|<tell_me_where>|<the_event_was_postpo>|<the_fucking_concert_>|<the_game_was_cancell>|<a_review_?>|<I_notify_problems_pa>|<i_see_your_payment_o>|<you_aren't_helping>|<you_arent_helping_an>|<you_arent_helping>|<your_not_helping>|<youre_not_helping>);\n\n<I_bought> = (I bought) (an item);\n<I_can't_find> = (I can't find) (my bill);\n<I_can't_find_1> = (I can't find) (my bills);\n<my_invoice_and_I_wan> = (I can't find) (my invoice and I want to view it);\n<I_can't_find> = (I can't find) (my invoice);\n<I_can't_remember> = (I can't remember) (my passwprd);\n<I_changed> = (I changed) (my mind);\n<I_didn't_receive> = (I didn't receive) (my invoices);\n<an_online_account> = (I don't have) (an online account);\n<I_don't_know_anythin> = (I don't know anything about your money back guarantee and I want information about it);\n<I_don't_know_anythin_1> = (I don't know anything about your money back policy and I want information about it);\n<I_don't_know_anythin> = (I don't know anything about your refund policy);\n<I_get_an_error_when> = (I get an error when) (I attempt to pay);\n<I_attempted_to_pay> = (I got an erreor when) (I attempted to pay);\n<I_attempted_to_make_> = (I got an error message when) (I attempted to make a payment);\n<I_have_a_problem_whe> = (I have a problem when trying ot make a payment with card);\n<I_have_a_problem_whe_1> = (I have a problem when trying to make a payment);\n<I_have_a_problem_whe> = (I have a problem when trying to pay);\n<I_have_an_issue_maki> = (I have an issue making) (a paymet);\n<I_have_an_issue_payi> = (I have an issue paying for my order);\n<I_have_no_shipping_a> = (I have no shipping address);\n<I_need_help_viewing> = (I need help viewing) (my bills);\n<I_need_information> = (I need information);\n<I_want_a_reimburseme> = (I want a reimbursement);\n<about_obtaining_an_i> = (I want to ask for information) (about obtaining an invoice);\n<to_change_my_order> = (I want to know how) (to change my order);\n<I_want_to_make> = (I want to make) (a comment);\n<I_want_to_make_1> = (I want to make) (a complaint for a service);\n<my_other_account> = (I want to use) (my other account);\n<I_want_to_view_cance> = (I want to view cancellation penalties);\n<I_want_to_view_your_> = (I want to view your reimbursement policy);\n<I_want> = (I want) (to download a bill);\n<to_get_information_a> = (I want) (to get information about downloading some invoices);\n<I_want> = (I want) (to submit a complaint);\n<to_see_the_status_of> = (I'd like) (to see the status of my order);\n<I'm_happy_wiht> = (I'm happy wiht) (the service);\n<I_try_to_pay_for_my_> = (an error message pops when) (I try to pay for my order);\n<ask_an_agent_how> = (ask an agent how) (to file an consumer complaint);\n<ask_an_agent_how_1> = (ask an agent how) (to modufy my purchase);\n<can_report_an_issue_> = (ask an agent where i) (can report an issue paying);\n<to_show_me_informati> = (ask an agent) (to show me information about) (the delivery period);\n<a_purchase_?> = (can I cancel) (a purchase ?);\n<my_account_password_> = (can I retrieve) (my account password ?);\n<my_user_account_?> = (can i close) (my user account ?);\n<can_check_their_mone> = (can u ask an agent if i) (can check their money back guarantee ?);\n<can_u_ask_an_agent_i> = (can u ask an agent if) (i could see the status of my refund);\n<can_you_find_informa> = (can you find information about) (the cancellation penalties ?);\n<can_you_show_me_the_> = (can you show me the mail of the Client Service ?);\n<can_register_two_acc> = (can you tell me if I) (can register two accounts with the same email ?);\n<I_can_create_several> = (can you tell me if) (I can create several accounts with the same email ?);\n<I_can_create_several_1> = (can you tell me if) (I can create several accounts with the same email address ?);\n<i_create_several_pro> = (can) (i create several profiles with the same email ?);\n<could_you_ask_an_age> = (could you ask an agent where) (to inform of fucking problems with my payment ?);\n<a_full_refund_in_cas> = (do I get) (a full refund in case) (I cancel my ticket ?);\n<a_fucking_payment_pr> = (help me notify) (a fucking payment problem);\n<help_me_obtain_an_in> = (help me obtain an invoice);\n<an_order_?> = (how can i make) (an order ?);\n<I_obtain_a_reimburse> = (how can) (I obtain a reimbursement ?);\n<i_notify_issues_payi> = (how could) (i notify issues paying ?);\n<an_online_account> = (i dont have) (an online account);\n<i_attempted_to_make_> = (i got an error when) (i attempted to make a payment);\n<i_got_an_error_when> = (i got an error when) (i tried to pay);\n<i_have_a_problem_mak> = (i have a problem making a payment with card);\n<i_have_an_issue_payi> = (i have an issue paying);\n<i_need_help_viewing_> = (i need help viewing your payment methods);\n<i_need_information> = (i need information);\n<a_product> = (i obught) (a product);\n<i_wanna_check> = (i wanna check) (my delivery);\n<i_wanna_get_an_invoi> = (i wanna get an invoice);\n<i_wanna_get> = (i wanna get) (a refund);\n<i_wanna_know_how_soo> = (i wanna know how soon) (i can expect my tickets);\n<a_review_for> = (i wanna make) (a review for) (a service);\n<i_wanna_notify_an_is> = (i wanna notify an issue making a payment);\n<i_wanna_see_the_mail> = (i wanna see the mail of the Client Service);\n<i_wanna_track> = (i wanna track) (my purchase);\n<i_wannaq_obtai_a_rei> = (i wannaq obtai a reimbursement);\n<about_requesting_som> = (i want to get information) (about requesting some invoices);\n<a_user_account> = (i want) (a user account);\n<to_inform_of_an_issu> = (i want) (to inform of an issue paying);\n<to_know_what_the_mai> = (i want) (to know what the mail of the Client Service is);\n<want_infomration> = (i) (want infomration);\n<information_about_do> = (information about downloading an invoice);\n<to_request_some_invo> = (is it possible) (to request some invoices ?);\n<my_online_account's_> = (my online account's been hacked);\n<please> = (please);\n<please_1> = (please);\n<my_account_password> = (someone stole) (my account password);\n<I_can_create_more_th> = (tell me if) (I can create more than one online account with) (a single email address);\n<tell_me_what_the_mai> = (tell me what the mail address of) (the Customer Support is);\n<tell_me_where> = (tell me where) (I can check my deliveries);\n<the_event_was_postpo> = (the event was postponed);\n<the_fucking_concert_> = (the fucking concert was postponed);\n<the_game_was_cancell> = (the game was cancelled);\n<a_review_?> = (where do i write) (a review ?);\n<I_notify_problems_pa> = (where do) (I notify problems paying ?);\n<i_see_your_payment_o> = (where do) (i see your payment options ?);\n<you_aren't_helping> = (you aren't helping);\n<you_arent_helping_an> = (you arent helping and i wanna talk) (to a human agent);\n<you_arent_helping> = (you arent helping);\n<your_not_helping> = (your not helping);\n<youre_not_helping> = (youre not helping);"},
		{name: "", args: args{f: "./data/tests/test5.csv"}, want: "#JSGF V1.0 ISO8859-1 en;\n\ngrammar main;\n\npublic <main> = (<I_don't_have_an_onli>);\n\n<I_don't_have_an_onli> = (I don't have an online account);"},
		{name: "", args: args{f: "./data/tests/test6.csv"}, want: "#JSGF V1.0 ISO8859-1 en;\n\ngrammar main;\n\npublic <main> = (<I_don't_have_an_onli>|<I_don't_understand_y>|<I_got_an_error_messa>|<I_want_an_online_acc>|<ask_an_agent_to_noti>|<can_you_show_me_info>|<can_you_show_me_my_i>|<can_you_tell_me_how_>|<i_dont_want_my_profi>|<i_want_to_know_wat_t>|<where_can_i_leave_an>);\n\n<I_don't_have_an_onli> = (I don't have an online account);\n<I_don't_understand_y> = (I don't understand you);\n<I_got_an_error_messa> = (I got an error message when I attempted to make a payment);\n<I_want_an_online_acc> = (I want an online accoynt);\n<ask_an_agent_to_noti> = (ask an agent to notify issues with my payment);\n<can_you_show_me_info> = (can you show me information about the status of my refund ?);\n<can_you_show_me_my_i> = (can you show me my invoices ?);\n<can_you_tell_me_how_> = (can you tell me how I can get some bills ?);\n<i_dont_want_my_profi> = (i dont want my profile);\n<i_want_to_know_wat_t> = (i want to know wat the email of Customer Service is);\n<where_can_i_leave_an> = (where can i leave an opinion for a service ?);"},
		{name: "", args: args{f: "./data/tests/test7.csv"}, want: emp},
		{name: "", args: args{f: "./data/tests/test8.csv"}, want: emp},
		{name: "", args: args{f: "./data/tests/test9.csv"}, want: "#JSGF V1.0 ISO8859-1 en;\n\ngrammar main;\n\npublic <main> = (<I_don't_have_an_onli>|<I_have_a_question>|<I_ordered_an_item_an>|<I_want_to_download_a>|<I_want_to_know_what_>|<I_want_to_make_a_rev>|<how_do_I_make_change>|<i_get_an_error_messa>|<i_want_to_request_an>|<where_do_i_check_the>|<you_arent_helping>);\n\n<I_don't_have_an_onli> = (I don't have an online account);\n<I_have_a_question> = (I have a question);\n<I_ordered_an_item_an> = (I ordered an item and Id like to modify my fucking order);\n<I_want_to_download_a> = (I want to download a bill);\n<I_want_to_know_what_> = (I want to know what the number of Customer Service is);\n<I_want_to_make_a_rev> = (I want to make a review for a service);\n<how_do_I_make_change> = (how do I make changes to my shipping address ?);\n<i_get_an_error_messa> = (i get an error message when i ty to make a payment for my order);\n<i_want_to_request_an> = (i want to request an invoice);\n<where_do_i_check_the> = (where do i check the delivery options ?);\n<you_arent_helping> = (you arent helping);"},
		{name: "", args: args{f: "./data/tests/test10.csv"}, want: emp},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			file, _ := os.Open(tt.args.f)
			defer file.Close()
			s := bufio.NewScanner(file)
			tx := ReadTexts(s)
			c := NewCorpus(tx)
			c.transitions = NewTransitions(c, tk)
			c.ngrams = ToNgrams(c.texts, tk, c.transitions, 0.1)
			c.texts = SplitTriplets(c.texts, c.ngrams)
			rules := ToRules(c.texts)
			rules = ApplyFactor(rules)
			rules = SetIDs(rules)
			g := Grammar{Rules: rules}
			assert.Equal(t, tt.want, g.printMain())
		})
	}
}
